<h1>Pocket Universe Division: Idle</h1>
<p>Total: {PlayerTotal.toFixed(0)}</p>
<p>CPS: {CoinsPerSecond.toFixed(2)}</p>
{#if BoostTimeRemaining > 0}
	<p style="color: #ff9800; font-weight: bold;">
		âš¡ Boost Active: {BoostTimeRemaining.toFixed(1)}s ({(BoostMultiplier * 100).toFixed(0)}% speed)
	</p>
{/if}

<div class="section stats-section">
	<h3>Current Levels</h3>
	<div class="stats-grid">
		<div class="stat-item">
			<span class="stat-label">Click Power:</span>
			<span class="stat-value">+{PerClickAmount}</span>
		</div>
		<div class="stat-item">
			<span class="stat-label">CPS Level:</span>
			<span class="stat-value">+{CoinsPerSecond}/sec</span>
		</div>
	</div>
</div>

<div class="section section--small">
	<label for="tick-progress"
		>Time to next CPS tick: {Math.max(0, TickIntervalSeconds - TickElapsedSeconds).toFixed(
			2
		)}s</label
	>
	<div id="tick-progress" class="progress progress--small">
		<div
			class="bar bar--tick"
			style="width: {(Math.min(1, TickElapsedSeconds / TickIntervalSeconds) * 100).toFixed(2)}%"
		></div>
	</div>
</div>

<div class="section">
	<label for="click-upgrade-progress">Progress to next click upgrade:</label>
	<button
		id="click-upgrade-progress"
		class="progress progress--large"
		onclick={BuyClickUpgrade}
		disabled={!CanBuyClickUpgrade}
		aria-label="Buy Click Upgrade (Cost: {NextClickUpgradeCost})"
	>
		<div
			class="bar bar--click"
			style="width: {Math.min(100, (PlayerTotal / NextClickUpgradeCost) * 100)}%"
		></div>
	</button>
</div>

<div class="button-grid">
	<button onclick={HandleClick}>Click! +{PerClickAmount}</button>
	<button onclick={BuyClickUpgrade} disabled={!CanBuyClickUpgrade}>
		Buy click power (Cost: {NextClickUpgradeCost})
	</button>

	<button
		id="cps-upgrade-progress"
		class="progress progress--large button-progress"
		onclick={BuyClickUpgrade}
		disabled={!CanBuyClickUpgrade}
		aria-label="Buy Click Upgrade"
	>
		<!-- progress fill -->
		<div
			class="bar bar--cps"
			style="width: {Math.min(100, (PlayerTotal / NextClickUpgradeCost) * 100)}%"
		></div>

		<!-- visible content on top of the bar -->
		<span class="progress-content">
			<span class="progress-title">Upgrade Click Power</span>
			<!-- <span class="progress-sub">Cost: {NextClickUpgradeCost}</span> -->
		</span>
	</button>

	<!-- combined progress bar + button for CPS -->
	<button
		id="cps-upgrade-progress"
		class="progress progress--large button-progress"
		onclick={BuyCPSUpgrade}
		disabled={!CanBuyCPSUpgrade}
		aria-label="Buy CPS Upgrade"
	>
		<!-- progress fill -->
		<div
			class="bar bar--cps"
			style="width: {Math.min(100, (PlayerTotal / CPSUpgradeCost()) * 100)}%"
		></div>

		<!-- visible content on top of the bar -->
		<span class="progress-content">
			<span class="progress-title">Upgrade Autoclick Power</span>
			<!-- <span class="progress-sub">Cost: {CPSUpgradeCost()}</span> -->
			<!-- <span class="progress-inc"
				>+{CPSIncrementForLevel(Math.round(CoinsPerSecond * 10)).toFixed(2)}/s</span
			> -->
		</span>
	</button>

	<button onclick={BuyTickBoost} disabled={!CanBuyBoost}>
		Buy Tick Boost (Cost: {BoostCost})
	</button>
	<button onclick={ResetGame} style="background: #f44336; color: white;"> Reset </button>
</div>

<div class="section history-section">
	<h3>Recent Actions</h3>
	<ul class="action-history">
		{#each ActionHistory as action (action)}
			<li>{action}</li>
		{/each}
	</ul>
</div>

<style>
	/* Global */
	:global(body) {
		margin: 0.5em;
		padding: 0;
		font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
		background: #f4f4f4;
	}

	:global(#svelte) {
		min-height: 100vh;
		padding: 1rem;
	}

	h1 {
		margin: 0 0 0.5rem 0;
		font-size: 1.5rem;
	}

	/* layout */
	.section {
		margin: 1em 0;
	}
	.section--small {
		margin: 0.5em 0;
	}

	/* progress containers */
	.progress {
		border-radius: 4px;
		overflow: hidden;
	}
	.progress--large {
		background: #eee;
		/* width: 100%; */
		/* max-width: 300px; */
		/* height: 24px; */
	}
	.progress--small {
		background: #222;
		/* width: 100%; */
		/* max-width: 200px; */
		/* height: 12px; */
		/* margin-top: 4px; */
	}

	/* bars */
	.bar {
		height: 100%;
		transition: width 0.2s ease;
	}

	.bar--tick {
		background: linear-gradient(90deg, #ff9800, #ffc107);
		transition: width 0.05s linear;
	}
	.bar--click {
		background: linear-gradient(90deg, #4caf50, #81c784);
	}
	.bar--cps {
		background: linear-gradient(90deg, #2196f3, #64b5f6);
	}

	/* buttons */
	button {
		border: none;
		border-radius: 4px;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		cursor: pointer;
	}

	button:hover:not(:disabled) {
		background: #f0f0f0;
	}

	button:disabled {
		cursor: not-allowed;
		pointer-events: none;
	}

	button.progress {
		padding: 0;
		cursor: pointer;
		font-size: inherit;
	}
	button.progress:disabled {
		cursor: not-allowed;
		pointer-events: none;
	}
	button.progress:not(:disabled):hover {
		/* border-color: #999; */
	}

	/* button grid */
	.button-grid {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
	}

	.button-grid button {
		flex: 1;
		margin: 0;
	}

	/* history */
	.history-section {
		margin-top: 2em;
		padding: 1em;
		background: #f5f5f5;
		border-radius: 8px;
	}

	.history-section h3 {
		margin: 0 0 0.5em 0;
		font-size: 1rem;
	}

	.action-history {
		list-style: none;
		padding: 0;
		margin: 0;
		font-size: 0.85rem;
	}

	.action-history li {
		padding: 0.25em 0;
		color: #666;
		border-bottom: 1px solid #ddd;
	}

	.action-history li:last-child {
		border-bottom: none;
	}

	/* stats section */
	.stats-section {
		background: #f0f8ff;
		padding: 1em;
		border-radius: 8px;
		margin: 1em 0;
	}
	.stats-section h3 {
		margin: 0 0 0.5em 0;
		font-size: 1rem;
	}
	.stats-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
		gap: 1em;
	}
	.stat-item {
		background: #fff;
		padding: 0.5em;
		border-radius: 4px;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
	}
	.stat-label {
		display: block;
		font-size: 0.9rem;
		margin-bottom: 0.2em;
		color: #333;
	}
	.stat-value {
		font-size: 1.2rem;
		color: #111;
	}

	/* tablet & desktop */
	@media (min-width: 640px) {
		:global(#svelte) {
			padding: 2rem;
			max-width: 1200px;
			margin: 0 auto;
		}

		h1 {
			font-size: 2rem;
		}

		.button-grid button {
			flex: 0 1 auto;
			min-width: auto;
		}
	}

	/* make progress buttons position-aware and overlay content readable */
	button.progress.button-progress {
		position: relative;
		padding: 1rem; /* bar occupies full height */
		overflow: hidden;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		text-align: center;
	}

	button.progress.button-progress .bar {
		position: absolute;
		left: 0;
		top: 0;
		height: 100%;
		width: 0%;
		z-index: 0;
		transition: width 0.25s ease;
	}

	button.progress.button-progress .progress-content {
		position: relative;
		z-index: 1;
		padding: 0;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		color: #111;
	}

	button.progress.button-progress .progress-sub,
	button.progress.button-progress .progress-inc {
		color: rgba(0, 0, 0, 0.7);
	}

	/* high-contrast text when bar is filled enough (optional) */
	button.progress.button-progress:enabled:hover .progress-content,
	button.progress.button-progress:enabled:focus .progress-content {
		color: #000;
	}

	/* disabled appearance */
	button.progress.button-progress:disabled {
		opacity: 0.6;
		pointer-events: none;
	}
</style>